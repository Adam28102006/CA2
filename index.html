<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1"> 

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> 

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style> 
body { 
background-color: #f8f9fa; 
} 
.section-title { 
margin-top: 60px; 
margin-bottom: 30px; 
} 
footer { 
margin-top: 60px; 
padding: 20px 0; 
background-color: #212529; 
color: white; 
} 
</style> 
</head> 
<body> 

<nav class="navbar navbar-expand-lg navbar-dark bg-dark"> 
<div class="container"> 
<a class="navbar-brand" href="#">NOE Project</a> 
</div> 
</nav> 

<div class="container"> 

<h1 class="text-center mt-5">Nature of Enterprise project- By Adam O'Connor Kenny, TJ Ermitano, Abdul Lafiaji, Micheal Juna and Jack Kells</h1> 
<p class="lead text-center">The effects of screentime on students</p> 

 
<h2 class="section-title">Dataset Overview</h2> 
<p> 
The dataset shows that there is a positive corrilation between how many hours you spend daily on a phone, and how little hours of sleep you get. The graphs also show that the more sleep students got lead to a higher mental health score, with the same being true for the more screentime leading to a higher addiction score.
</p> 

<div class="row text-center"> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Mean Screentime </h5> 
<p id="meanValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Median Screentime </h5> 
<p id="medianValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
<div class="col-md-4"> 
<div class="card shadow-sm"> 
<div class="card-body"> 
<h5>Standard Deviation of Screentime</h5> 
<p id="stdValue" class="display-6">--</p> 
</div> 
</div> 
</div> 
</div> 

<h2 class="section-title">Data Visualisation</h2> 
<div class="row"> 
<div class="col-md-6"> 
<canvas id="barChart"></canvas> 
</div> 
<div class="col-md-6"> 
<canvas id="lineChart"></canvas> 
</div> 
</div> 


<h2 class="section-title">Machine Learning Model</h2>
<p>  
For the Machine Learning part in our CA we chose to do a Linear Regression as I felt it was a better option for our dataset. I used linear regression to predict students Addicted Score based on their Average Screentime. The idea itself was very basic the more our average screentime is the more addicted score we'll get. 
 
The only used feature is Average Screentime, it’s very simple as it’s only one input but it does what we want from it. It shows a clear resemblance between Addicted Score and Average Screentime 
 
The model performed well as we can see in the graph. The graph shows that the Regression followed the general idea of the more screentime the more addicted we are which confirms the initial idea. It’s not perfect since we can see quite the spread in some points, but the pattern itself seems fine and make sense on a daily basis. 
</p>
<script>
async function loadExcel() {
    try {
        const rawUrl = "https://raw.githubusercontent.com/Adam28102006/CA2/main/Book.xlsx";
        const response = await fetch(rawUrl);
        if (!response.ok) throw new Error("Failed to fetch Excel file");

        const data = await response.arrayBuffer();
        const workbook = XLSX.read(data, { type: "array" });

        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];

        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

        const screenColIndex = 4; 
        const sleepColIndex = 7;

        const screenData = [];
        const sleepData = [];

        for (let i = 1; i < jsonData.length; i++) {
            const row = jsonData[i];
            if (!row) continue;

            const screenVal = Number(row[screenColIndex]);
            const sleepVal = Number(row[sleepColIndex]);

            if (!isNaN(screenVal) && !isNaN(sleepVal)) {
                screenData.push(screenVal);
                sleepData.push(sleepVal);
            }
        }

        if (screenData.length === 0) {
            console.error("No valid data found.");
            return;
        }

        updateStatistics(screenData);
        createScatterChart(sleepData, screenData);

    } catch (err) {
        console.error("Error loading Excel file:", err);
    }
}

function mean(arr) {
    return arr.reduce((a,b)=>a+b,0)/arr.length;
}

function median(arr) {
    const sorted = [...arr].sort((a,b)=>a-b);
    const mid = Math.floor(sorted.length/2);
    return arr.length % 2 !== 0 
        ? sorted[mid] 
        : (sorted[mid-1]+sorted[mid])/2;
}

function stdDev(arr) {
    const m = mean(arr);
    return Math.sqrt(arr.reduce((sq,n)=>sq+Math.pow(n-m,2),0)/arr.length);
}

function updateStatistics(data) {
    document.getElementById("meanValue").innerText = mean(data).toFixed(2);
    document.getElementById("medianValue").innerText = median(data).toFixed(2);
    document.getElementById("stdValue").innerText = stdDev(data).toFixed(2);
}

function createScatterChart(xData, yData) {
    const points = xData.map((x, i) => ({
        x: x,
        y: yData[i]
    }));

    new Chart(document.getElementById("barChart"), {
        type: "scatter",
        data: {
            datasets: [{
                label: "Sleep vs Screentime",
                data: points,
                backgroundColor: "rgba(54, 162, 235, 0.7)"
            }]
        },
        options: {
            scales: {
                x: {
                    title: {
                        display: true,
                        text: "Hours of Sleep"
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: "Hours of Screentime"
                    }
                }
            }
        }
    });
}

loadExcel();
</script>


</body> 
</html>
